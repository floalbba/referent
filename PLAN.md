# План добавления функций кнопок (PROJECT.md)

На основании PROJECT.md: приложение парсит статью по URL и по кнопке подключает AI для выполнения действия. Ниже — порядок действий для реализации кнопок «О чем статья?», «Тезисы», «Пост для Telegram».

---

## 1. Общая логика

- Все три кнопки работают с уже распарсенной статьёй (после «Получить статью»).
- Каждая кнопка отправляет текст статьи в AI с разным промптом.
- Результат выводится в блок «Результат».
- Используется тот же OpenRouter API и модель, что и для перевода.

---

## 2. Порядок действий

### Шаг 1. Создать API-маршрут для AI-действий

Создать `app/api/ai-action/route.ts`:

- Принимает `POST` с телом `{ content: string, action: "about" | "theses" | "telegram" }`.
- Использует `OPENROUTER_API_KEY` и модель `deepseek/deepseek-r1-0528:free`.
- Формирует промпт в зависимости от `action`.
- Возвращает `{ result: string }` или `{ error: string }`.
- Обрабатывает ошибки (401, 402, 429) по аналогии с `/api/translate`.

### Шаг 2. Определить промпты для каждого действия

| action   | Промпт |
|----------|--------|
| `about`  | Кратко (2–3 предложения) опиши, о чём эта статья. Ответ на русском. |
| `theses` | Составь тезисы статьи (основные мысли по пунктам). Ответ на русском. |
| `telegram` | Сделай пост для Telegram: краткое содержание, цепляющее начало, до ~500 символов. Ответ на русском. |

### Шаг 3. Обновить `handleAction` на странице

В `app/page.tsx`:

- Проверять наличие `parsedContent` (если пусто — сообщение «Сначала нажмите «Получить статью»»).
- Вызывать `POST /api/ai-action` с `{ content: parsedContent, action: type }`.
- Показывать «Загрузка…» во время запроса.
- Выводить `data.result` в блок «Результат» при успехе, `data.error` при ошибке.
- Убрать заглушку с `setTimeout` и фиктивным текстом.

### Шаг 4. Проверка и доработка

- Проверить работу каждой кнопки локально.
- При необходимости уточнить промпты (длина, тон, формат).
- Убедиться, что на Vercel задан `OPENROUTER_API_KEY` для работы на продакшене.

---

## 3. Зависимости

- Парсинг статьи уже реализован (`/api/parse`).
- OpenRouter и модель уже настроены в `/api/translate` — логику можно переиспользовать.
- Кнопки и блок «Результат» уже есть в интерфейсе.

---

## 4. Альтернатива: один маршрут вместо трёх

Вместо трёх отдельных маршрутов — один `/api/ai-action` с параметром `action`. Это упрощает поддержку и добавление новых типов действий.
